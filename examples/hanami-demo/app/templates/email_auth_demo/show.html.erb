<h2>Email Authentication (Passwordless Login)</h2>

<div class="flash notice">
  <p>Email authentication allows you to log in without a password by clicking a link sent to your email.</p>
</div>

<h3>What is Email Authentication?</h3>
<p>
  Email authentication (also known as "passwordless login" or "magic link") is a secure way to log in
  without remembering a password. Instead, you receive a unique, time-limited link via email that
  logs you in when clicked.
</p>

<h3>How It Works</h3>
<ol>
  <li><strong>Request Login</strong> - Enter your email address</li>
  <li><strong>Check Email</strong> - A unique login link is sent to your email</li>
  <li><strong>Click Link</strong> - Click the link to authenticate</li>
  <li><strong>Logged In</strong> - You're automatically logged in</li>
</ol>

<h3>Benefits</h3>
<ul>
  <li><strong>No Password to Remember</strong> - No need to create or remember complex passwords</li>
  <li><strong>Secure</strong> - Each link is unique, time-limited, and single-use</li>
  <li><strong>Easy</strong> - Perfect for infrequent users or low-friction experiences</li>
  <li><strong>Email Verification</strong> - Proves you have access to the email address</li>
</ul>

<h3>Security Features</h3>
<div class="security-features">
  <ul>
    <li><strong>Time-Limited</strong> - Links expire after 2 hours</li>
    <li><strong>Single-Use</strong> - Each link can only be used once</li>
    <li><strong>Rate Limiting</strong> - Prevents spam by limiting email frequency (5 minutes between emails)</li>
    <li><strong>Audit Logging</strong> - All login attempts are tracked</li>
  </ul>
</div>

<h3>Try It Now</h3>
<div class="demo-action">
  <p>
    <a href="/email-auth" class="button">Request Email Login Link</a>
  </p>
  <p>
    <small>Note: In this demo, emails are not actually sent. Check the server console for the login link.</small>
  </p>
</div>

<h3>Example Flow</h3>
<div class="flow-example">
  <pre>
1. Visit /email-auth
2. Enter your email address
3. Submit the form
4. Check your email for the login link
5. Click the link (format: /email-auth?key=...)
6. You're automatically logged in!
  </pre>
</div>

<h3>JSON API Endpoints</h3>
<p>For SPA/mobile applications, these endpoints are available:</p>
<ul>
  <li>
    <code>POST /email-auth-request</code>
    <br>Request an email auth link
    <br>Request: <code>{ "login": "user@example.com" }</code>
    <br>Response: <code>{ "success": true }</code>
  </li>
  <li>
    <code>POST /email-auth</code>
    <br>Verify and authenticate with email key
    <br>Request: <code>{ "key": "unique-key-from-email" }</code>
    <br>Response: <code>{ "success": true, "account_id": 123 }</code>
  </li>
</ul>

<h3>Example API Usage</h3>
<div class="api-example">
  <h4>Request Login Link</h4>
  <pre>
curl -X POST http://localhost:2300/email-auth-request \
  -H "Content-Type: application/json" \
  -d '{"login": "user@example.com"}'
  </pre>

  <h4>Authenticate with Key</h4>
  <pre>
curl -X POST http://localhost:2300/email-auth \
  -H "Content-Type: application/json" \
  -d '{"key": "unique-key-from-email"}'
  </pre>
</div>

<h3>Use Cases</h3>
<p>Email authentication is perfect for:</p>
<ul>
  <li>Consumer-facing applications where ease of use is paramount</li>
  <li>Infrequent users who might forget passwords</li>
  <li>Mobile apps where typing passwords is inconvenient</li>
  <li>Temporary access or guest accounts</li>
  <li>Account recovery when combined with password auth</li>
</ul>

<h3>Combining with Other Auth Methods</h3>
<p>
  Email authentication can be used alongside traditional password authentication. Users can choose
  their preferred method:
</p>
<ul>
  <li>Regular login with password</li>
  <li>Passwordless login via email link</li>
  <li>Both methods enabled for flexibility</li>
</ul>

<p>
  <a href="/" class="button">Back to Home</a>
  <a href="/login">Traditional Login</a>
</p>

<style>
  .security-features {
    background: #e7f3ff;
    border: 1px solid #007bff;
    padding: 15px;
    border-radius: 4px;
    margin: 20px 0;
  }

  .demo-action {
    background: #f0f8ff;
    padding: 20px;
    border-radius: 4px;
    margin: 20px 0;
    text-align: center;
  }

  .flow-example, .api-example {
    background: #f5f5f5;
    padding: 15px;
    border-radius: 4px;
    margin: 20px 0;
  }

  .flow-example pre, .api-example pre {
    margin: 0;
    font-family: monospace;
    line-height: 1.6;
    overflow-x: auto;
  }

  .api-example h4 {
    margin: 15px 0 10px 0;
    color: #007bff;
  }

  .api-example h4:first-child {
    margin-top: 0;
  }

  code {
    background: #f5f5f5;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: monospace;
    font-size: 0.9em;
  }
</style>
