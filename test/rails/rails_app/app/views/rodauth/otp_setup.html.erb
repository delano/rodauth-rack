<h1>Setup Two-Factor Authentication (TOTP)</h1>

<div class="otp-setup-container">
  <p>Scan this QR code with your authenticator app (Google Authenticator, Authy, 1Password, etc.):</p>

  <div class="qr-code">
    <%= raw otp_qr_code %>
  </div>

  <p>Or manually enter this secret key:</p>
  <code class="otp-secret"><%= otp_user_key %></code>

  <%= form_with url: otp_setup_path, method: :post, local: true do |form| %>
    <div class="form-group">
      <%= label_tag otp_setup_param, "Authentication Code:" %>
      <%= password_field_tag otp_setup_param, "", autocomplete: "off", placeholder: "Enter 6-digit code", class: "form-control" %>
    </div>

    <% if two_factor_modifications_require_password? %>
      <div class="form-group">
        <%= label_tag password_param, "Current Password:" %>
        <%= password_field_tag password_param, "", autocomplete: "current-password", class: "form-control" %>
      </div>
    <% end %>

    <%= raw csrf_tag %>
    <%= submit_tag "Setup TOTP Authentication", class: "btn btn-primary" %>
  <% end %>
</div>
